
-- create EMPLOYEE
CREATE TABLE EMPLOYEE (
  id INTEGER PRIMARY KEY,
  name TEXT NOT NULL,
  salary TEXT NOT NULL,
  dept_id TEXT NOT NULL
);

-- insert EMPLOYEE
INSERT INTO EMPLOYEE VALUES (1, 'Candice', '4685','1');
INSERT INTO EMPLOYEE VALUES (2, 'Julia', '2559','2');
INSERT INTO EMPLOYEE VALUES (3, 'Bob', '4405','4');
INSERT INTO EMPLOYEE VALUES (4, 'Scarlet', '2350','1');
INSERT INTO EMPLOYEE VALUES (5, 'Ileana', '1151','4');

-- create DEPARTMENT
CREATE TABLE DEPARTMENT (
  id INTEGER PRIMARY KEY,
  name TEXT NOT NULL,
  location TEXT NOT NULL
);

-- insert DEPARTMENT
INSERT INTO DEPARTMENT VALUES (1, 'Executive', 'Sydney');
INSERT INTO DEPARTMENT VALUES (2, 'Production', 'Sydney');
INSERT INTO DEPARTMENT VALUES (3, 'Resources', 'Cape Town');
INSERT INTO DEPARTMENT VALUES (4, 'Technical', 'Texas');
INSERT INTO DEPARTMENT VALUES (5, 'Management', 'Paris');

-- fetch EMPLOYEE
SELECT * FROM EMPLOYEE;

-- fetch DEPARTMENT
SELECT * FROM DEPARTMENT;

SELECT DEPARTMENT.name,COUNT(EMPLOYEE.dept_id) AS employee_count
FROM DEPARTMENT
LEFT JOIN EMPLOYEE ON DEPARTMENT.id = EMPLOYEE.dept_id
GROUP BY DEPARTMENT.name
ORDER BY employee_count DESC, DEPARTMENT.name ASC;
